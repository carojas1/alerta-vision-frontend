<div class="reports-main">
  <header>
    <h1 class="reports-title">Reportes</h1>
  </header>

  <!-- Tabs -->
  <div class="reports-tabs">
    <button [class.active]="activeTab === 'diario'" (click)="selectTab('diario')">Diario</button>
    <button [class.active]="activeTab === 'semanal'" (click)="selectTab('semanal')">Semanal</button>
    <button [class.active]="activeTab === 'mensual'" (click)="selectTab('mensual')">Mensual</button>
  </div>

  <!-- Card y gráfica -->
  <div class="reports-card">
    <div class="chart-container">
      <canvas
        baseChart
        [data]="barChartData"
        [options]="barChartOptions"
        type="bar">
      </canvas>
    </div>

    <div class="average-box">
      <div class="prom-label">Somnolencia promedio</div>
      <div class="prom-value">{{ getBarChartAverage() | number:'1.1-1' }}</div>
      <div class="prom-unit">
        por {{ activeTab === 'diario' ? 'día' : (activeTab === 'semanal' ? 'semana' : 'mes') }}
      </div>
      <div class="mas-som">
        {{ activeTab === 'diario' ? 'Día' : (activeTab === 'semanal' ? 'Semana' : 'Mes') }} con más somnolencia:
        <span class="destacado">{{ diaMasSomnoliento }}</span>
      </div>
    </div>

    <div class="exportar-box">
      <span class="exportar-label">Exportar datos:</span>
      <button (click)="exportarCorreo()" [disabled]="exportando" class="exportar-btn">
        {{ exportando ? 'Enviando...' : 'Enviar informe a mi correo' }}
      </button>
    </div>

    <div class="historial-box">
      <div class="historial-label">Historial de exportaciones</div>
      <div class="mini-bar">
        <div *ngFor="let h of historialExportaciones" class="mini-bar-item">
          <div class="mini-bar-bar" [style.height.%]="h.valor"></div>
          <div class="mini-bar-fecha">{{ h.fecha }}</div>
        </div>
      </div>
      <div class="mini-bar-desc">Últimas {{ historialExportaciones.length }} exportaciones realizadas</div>
    </div>
  </div>

  <!-- Footer -->
  <nav class="nav-bottom">
    <div class="nav-btn" (click)="goTo('home')">
      <img src="/fluent-color--home-32.svg" alt="Inicio" class="nav-icon" />
      <div>Inicio</div>
    </div>
    <div class="nav-btn" (click)="goTo('history')">
      <img src="/icon-park--history-query.svg" alt="Alertas" class="nav-icon" />
      <div>Alertas</div>
    </div>
    <div class="nav-btn active">
      <img src="/iconoir--reports-solid.svg" alt="Reportes" class="nav-icon" />
      <div>Reportes</div>
    </div>
  </nav>
</div>
